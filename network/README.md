# Network

## Table of Contents

OSI 7계층

- OSI 7계층이란?
- OSI 7계층이 필요한 이유는?
- OSI 7계층과 TCP/IP 4계층을 비교해본다면?
- 주소창에 www.naver.com을 입력 후 접속했을 때의 무슨 일이 일어날까?

OSI Physical Layer(물리 계층, 1계층)

- OSI Physical Layer란?

OSI 2계층(Data-link Layer)

- OSI 2계층(Data-link Layer)이란?
- TCP/IP Network layer(1계층)란?
- 데이터 링크 계층의 주요 역할은?
- 2계층에서 데이터가 hop-by-hop으로 전달된다는 것의 의미는 무엇일까?
- 프레이밍이란?
- 프레임의 구조(필드)는?
- MAC 주소란?
- MAC 주소와 IP 주소의 차이점은?
- MAC 주소의 종류에는 어떤 것들이 있을까?
- 스위치란?
- 스위치의 포워딩 방식에 대해 설명해본다면?
- store-and-forward에서 프레임의 오류를 체크하는 방식은?
- MAC 주소 테이블이란?
- MAC 주소 테이블이 동작하는 과정은?
- LAN과 WAN의 차이점?
- 접근 제어란?
- 흐름 제어(Flow control)란?
- 순서 제어란?
- 오류 제어란?
- 이더넷이란?
- 이더넷의 특징?
- 이더넷의 장단점?

OSI Network Layer(3계층) & TCP/IP Internet Layer(2계층)

- OSI Network layer(TCP/IP Internet layer)란?
- 라우터란?
- 라우팅이란?
- 정적 라우팅과 동적 라우팅이란?
- 포워딩이란?
- 포워딩 테이블이란?
- 스위치와 라우터의 차이점은?
- 스위치와 라우터의 공통점은?
- AS(Autonomous System, 자치 시스템)란?
- IP(Internet Protocol)란?
- 네트워크에서 '신뢰성'이 의미하는 것은?
- ICMP(Internet Control Message Protocol)란?
- IP의 데이터그램 단편화(fragmentation)란?
- IP 데이터그램 단편화/재조립에 사용되는 IP 헤더의 종류에는 어떤 것들이
- IPv6란?
- ARP(Address Resolution Protocol)란?
- ARP 테이블이란?
- 같은 LAN 상에서의 전송에서 ARP가 진행되는 과정은?
- DHCP(Dynamic Host Configuration Protocol, 동적 호스트 구성 프로토콜)란?
- DHCP의 장단점?
- DHCP에서 IP 주소를 할당 받으면 영원히 사용할 수 있을까?
- DHCP가 ip주소를 임대해주는 절차? `보충`

OSI Transport Layer(4계층) & TCP/IP Transport Layer(3계층)

- Transport Layer란?
- network layer(3계층)와 Transport Layer(4계층)와의 차이점은?
- Transport Layer가 흐름 제어를 제공하는 방법?
- 혼잡 제어(Congestion control란?
- Transport Layer가 혼잡 제어를 제공하는 방법?
- AIMD(합 증가/곱 감소)란?
- Slow start(느린 시작)란?
- Fast retransmit(빠른 재전송)이란?
- Transport Layer가 오류 제어를 제공하는 방법은?

TCP & UDP

- TCP(Transmission Control Protocol)란?
- UDP(User Datagram Protocol)란?
- 연결형 서비스와 비연결형 서비스의 차이점은?
- 데이터그램 방식과 가상 회선 방식이란?
- 가상 회선 방식에서 논리적 연결이 설정되는 과정은?
- 회선 구성 방식에는 어떤 것들이 있을까?
- 전이중, 반이중, 단방향 방식에 대해 설명해본다면?
- TCP와 UDP는 각각 어떤 특성의 서비스에 적합할까?
- 3-way handshake의 과정에 대해 설명해본다면?
- 4-way handshake의 과정에 대해 설명해본다면?
- 왜 2-way handshake는 성립될 수 없을까?

OSI Application Layer(응용 계층, 7계층) & TCP/IP Application Layer(4계층)

- 응용 계층이란?

DNS

- DNS(Domain Name Server)란?
- 도메인 네임(domain name)이란?
- 도메인 네임의 구조?
- DNS에서 도메인을 얻어오는 과정은?
- PC는 local DNS의 ip 주소를 어떻게 알고 있을까?
- DNS의 구성 요소는?
- 도메인 네임 스페이스란?
- 네임 서버란?
- 네임 서버의 종류는?
- resolver란?
- DNS가 사용하는 전송 계층(Transport Layer)의 프로토콜은?
- DNS에 UDP를 사용하는 이유?

---

## OSI 7계층

### OSI 7계층이란?

- 네트워크 프로토콜 디자인을 계층으로 나누어 설명한 것.
- Physical Layer, Data-link Layer, Network Layer, Transport Layer, Session Layer, Presentation Layer, Application Layer로 구성되어 있다.

---

### OSI 7계층이 필요한 이유는?

- 통신이 일어나는 과정을 단계별로 파악할 수 있다.
- 이상이 생겼을 때, 다른 단계의 장비나 소프트웨어를 건드리지 않고 이상이 생긴 단계의 모듈만 고치면 된다.

---

### OSI 7계층과 TCP/IP 4계층을 비교해본다면?

![Network%200208784d439545d2a6f93e6c5c4355bc/osi-vs-tcp-ip.png](Network%200208784d439545d2a6f93e6c5c4355bc/osi-vs-tcp-ip.png)

> tcp/ip는
>
> - osi보다 먼저 개발되었고,
> - osi는 실제 개발된 사례가 많이 없어서 신뢰도가 떨어지는 반면,
>   tcp/ip는 계속적으로 실제 개발되고, 발전되면서 실질적인 표준이 되었다.

---

### 주소창에 www.naver.com을 입력 후 접속했을 때의 무슨 일이 일어날까?

사용자가 브라우저의 URL 주소창에 주소를 입력하고 접속하면,

브라우저는 URL 주소 중 domain name에 해당하는 부분을 DNS에 검색한다.

- DNS 서버는 해당 도메인 네임에 해당하는 IP 주소를 브라우저에게 응답한다.

브라우저는 IP주소로 HTTP 프로토콜을 사용해 HTTP 요청 메시지를 생성한다.

- 생성된 요청 메시지는 TCP/IP 프로토콜을 통해 해당 IP주소를 가지는 컴퓨터로 전송된다.
- 도착한 메시지는 HTTP 프로토콜로 인해 URL 정보로 변환된다.

웹 서버는 URL 정보에 해당하는 정보를 검색한다.

- 찾은 정보를 HTTP 프로토콜을 사용해 응답 메시지로 생성한다.
- 생성된 HTTP 응답 메시지는 TCP/IP 프로토콜을 통해 요청을 보냈던 컴퓨터로 전송된다.

도착한 HTTP 응답 메시지는 HTTP 프로토콜을 통해 웹 페이지 데이터로 변환된다.

- 브라우저는 웹 페이지 데이터를 파싱해서 렌더링한다.

## OSI Physical Layer(물리 계층, 1계층)

### OSI Physical Layer란?

물리적으로 연결된 두 대의 컴퓨터가 디지털 신호를 주고 받도록 해주는 모듈.

> - 물리 계층은 미디어 타입, 신호 표현 방법, 속도 등을 몀시한다.
> - 물리 계층의 PDU(Protocol Data Unit)는 비트(bit)이다.
> - 물리 계층은 두 대의 컴퓨터가 통신할 수 있도록 해주지만, 여러 대의 컴퓨터가 통신할 수는 없다.
> - 물리 계층은 하드웨어의 PHY칩에 구현되어 있다.

> 아날로그 신호와 디지털 신호의 차이점
>
> - 아날로그 신호: 연속된 값을 가진다.
> - 디지털 신호: 비연속적 값(= 0과 1)을 가진다.

---

## OSI Data-link Layer(2계층)

### OSI Data-link Layer란?

- "직접 연결된(인접한)" 서로 다른 2개의 네트워킹 장치 간의 데이터 전송을 담당하는 모듈.
- 물리 계층으로부터 받은 데이터가 네트워크 장치에 올바르게 안착될 수 있도록 하는 역할을 한다.

> - data-link layer의 PDU은 프레임(Frame)이다.
> - 어느 방향으로 가야 하는지는 상위 프로토콜(네트워크 계층)이 책임진다. 데이터링크 계층은 상위 프로토콜이 가리키는 곳으로 데이터를 전송할 뿐이다.
> - LAN에서 데이터를 주고 받기 위해 필요하다.

---

### TCP/IP Network (Interface) layer(1계층)란?

- 물리적 연결을 포함해, "직접 연결된(인접한)" 서로 다른 2개의 네트워킹 장치 간의 데이터 전송을 담당하는 모듈.

> - TCP/IP의 network layer는 OSI physical layer와 data-link layer에 해당한다.
> - network layer의 PDU은 프레임(Frame)이다.

---

### 데이터 링크 계층의 주요 역할은?

- 프레이밍(Framing)
- 물리 주소(MAC) 지정
- 접근 제어/ 흐름 제어/ 순서 제어/ 오류 제어

---

### 2계층에서 데이터가 hop-by-hop으로 전달된다는 것의 의미는 무엇일까?

(종단에서 종단으로 데이터가 한번에 직접 전달되는 것이 아니라) 두 종단 사이에 존재하는 라우터들을 거치며 점진적으로 전달이 된다는 의미이다.

> IP 주소간의 통신은 각 라우터 hop에서 일어나는 MAC 주소와 MAC 주소 통신의 연속적인 과정이다.

---

### 프레이밍이란?

네트워크 계층으로부터 전달 받은 데이터그램을 캡슐화하는 작업.

---

### 프레임의 구조(필드)는?

- 출발지 MAC 주소/ 목적지 MAC 주소
- data: 실제 전송되는 데이터.
- length / type: 데이터 필드 길이나 프로토콜 종류를 나타냄
- SOF(Start of Frame): 10101011의 값을 가짐. 프레임의 시작을 알린다.
- Frame Check Sequence: 에러 발생 여부를 확인하기 위한 필드.
- Preemble: 10101010이 반복되는 필드. 수신측에서 프레임이 전송된다는 것을 알리고, 곧 도착할 프레임에서 0과 1을 제대로 구분할 수 있도록 동기 신호를 제공하는 것.

---

### MAC 주소란?

랜 카드(또는 네트워크 인터페이스 카드(NIC))에 할당되는 고유한 식별자 주소.

> - 데이터 링크 계층에서 통신을 위해 사용된다.
> - 모든 네트워크 장비(라우터, 스위치 등)가 지니고 있다.
> - 48비트(00:00:00:00:00:00 꼴)
> - '물리 주소', '하드웨어 주소'라고도 불린다.

---

### MAC 주소와 IP 주소의 차이점은?

- IP 주소: 최종 목적지의 '논리적' 주소.
- MAC 주소: 최종 목적지까지 가기 위해 거쳐가야 하는 경로 상, 바로 다음 라우터의 '물리적' 주소.

> - 앨리스가 밥에게 데이터를 전송할 때, IP는 밥의 컴퓨터의 IP 주소를 나타낼 것이고 MAC 주소는 바로 다음 라우터의 MAC 주소를 나타낼 것이다.

---

### MAC 주소의 종류에는 어떤 것들이 있을까?

수신자가 몇 개인지에 따라 3종류로 나뉜다.

1. Unicast

- `1 : 1` 통신을 의미.
- (L2 계층에서) Framing을 할 때 unicast address를 넣으면 해당 MAC 주소를 가진 곳으로만 간다.

2. multicast

- `1 : 다` 통신을 의미.
- 특정 관할 구역에서 제한적으로 사용됨.

3. broadcast

- `1 : 전체` 통신을 의미.
- broadcast address를 담은 frame은 (네트워크에 연결된) 모든 기기에 전달된다.

  > 일반적으로 broadcast address는` FF:FF:FF:FF:FF:FF`이다.

---

### 스위치란?

같은 네트워크 내에서 데이터를 전달하는 역할을 하는 네트워크 장치.

- 프레임을 수신하면, MAC 테이블을 참조해 어떤 포트로 프레임을 보낼지 결정한다.

> - 스위치는 데이터링크 계층에서 사용되는 대표적인 장비이다.

---

### 스위치의 포워딩 방식에 대해 설명해본다면?

1. cut-through

- 프레임 전체를 확인하지 않고, 수신되는 프레임의 목적지 MAC 주소만 확인해서 목적지 포트로 프레임을 전송하는 방식
- 장점: 전송 대기 시간을 최소화하는 방식이다.
- 단점: 프레임의 에러를 제거할 수 있는 기능을 지원하지 않는다.

> - cut-through 방식은 에러가 발생한 프레임이 수신되었을 경우, 이를 폐기시킨 후 재전송될 프레임을 기다린다.

2. store-and-forward

- 하나의 프레임을 수신할 때 프레임 전체를 확인해 에러를 체크한 후에 목적지 포트로 전송하는 방식.
- 장점: 에러를 체크하기 때문에 신뢰도가 높다.
- 단점: 비교적 속도가 느리고 오버헤드가 든다.

---

### store-and-forward에서 프레임의 오류를 체크하는 방식은?

CRC(cyclic redundancy check, 순환 중복 검사) 방식을 쓴다.

- 데이터 전송 전 CRC 값을 계산해 데이터에 붙여 전송한다.
- 데이터를 수신하는 측에서 CRC 값을 계산한 후, 데이터에 부착된 CRC 값과 비교한다.

> CRC를 통해 무결성을 보장할 수 있다.

---

### MAC 주소 테이블이란?

목적지 MAC 주소와, 해당 MAC 주소로 가기 위한 포트 번호가 기록된 테이블.

> - 프레임의 목적지 MAC 주소와 포트 번호를 캐싱하기 위해 사용된다.

---

### MAC 주소 테이블이 동작하는 과정은?

- 스위치가 프레임을 수신하면, 프레임의 목적지 MAC 주소를 확인한다.
- MAC 주소 테이블에 해당 MAC 주소가 존재하면, 매칭되는 포트로 프레임을 전송한다.
- 만일 MAC 주소가 존재하지 않는다면, ARP를 통해 MAC 주소를 알아낸 후 해당하는 포트로 전송한다.

> - 스위치의 MAC 주소 테이블은 자동으로 동작한다. 즉, 프레임이 스위치를 거치면 해당 MAC 주소와 포트가 맥 주소 테이블에 등록이 된다.
> - 맥 주소 테이블의 entry는 시간이 지나면 삭제가 된다. (default 300초)

---

### LAN과 WAN의 차이점?

LAN(Local Area Network, 근거리 통신망)

- 지역 네트워크

> - LAN은 ARP Request 패킷이 도달하는 범위의 기준이기도 하다.

WAN(Wide Area Network, 원거리 통신망)

- 광범위한 지역 단위로 LAN과 LAN을 연결하는 네트워크.

---

### 접근 제어란?

여러 장비가 하나의 링크(매체)를 공유해 다중 접속되어 있는 경우, 여러 장비에서 발생한 신호로 인해 충돌이 발생한다. 이러한 충돌을 최소화하고, 충돌이 발생했을 경우 대응하는 것을 말한다.

> 접근 제어를 제공하는 기능으로는 대표적으로 CSMA/CD가 있다.
>
> CSMA/CD란?
>
> - CS(Carrier Sense), MA(Multiple Access)
>
>   - 다른 장비가 통신 중인지를 미리 확인해서 충돌을 최소화하는 기능.
>   - 공유 매체에 아무런 전기 신호가 발생하지 않으면 데이터 전송을 시도한다. 다른 장비가 사용 중이면 잠시 기다렸다가 전송을 시도한다.
>
> - CD(Collision Detect)
>
>   - 충돌이 일어났을 때 대처하는 기능.
>   - 충돌이 감지되면 연결된 모든 장비에게 Signal을 전달하여 충돌이 발생했음을 알린다. 신호를 받은 장비들은 랜덤한 시간을 기다렸다가 재전송을 한다.

---

### 흐름 제어(Flow control)란?

송신측이 수신측의 처리 속도보다 더 빨리 데이터를 보내지 않도록 제어해주는 것.

- 데이터 링크 계층에서는 송신측의 최고 전송 속도와 수신측의 최고 처리 속도를 서로 공유하여, 더 낮은 속도에 두 노드가 속도를 맞춤으로써 흐름 제어를 제공한다.

> 데이터 링크 계층의 흐름 제어는 노드 대 노드 간의 흐름 제어를,
> 전송 계층의 흐름 제어는 종단 간의 흐름을 제어한다.

---

### 순서 제어란?

패킷이 송신한 순서대로 목적지에 도착하도록 하는 것

- 데이터 링크 계층에서는 패킷에 Sequence Number를 부여해 패킷의 순서가 혼동되지 않도록 함으로써 순서 제어를 제공한다.

---

### 오류 제어란?

데이터 전송 시 발생한 오류를 복원하거나 재전송하는 것.

- 데이터 링크 계층에서의 오류 제어는 '오류 검출'과 '재전송' 과정으로 구성된다.
- 수신측에서 오류를 검출하고, 오류가 발생하면 송신측에서 해당 패킷을 재전송한다.
- 송신측은 타이머와 ACK 패킷 등으로 오류 발생 여부를 알 수 있다.

---

### 이더넷이란?

LAN에서 사용하기 위해 개발된 유선 통신망 기술.

> 이더넷(Ethernet)은 데이터 링크 계층의 대표적인 프로토콜이다.

---

### 이더넷의 특징?

- 비연결형 서비스: 송신 - 수신 노드 사이에 handshake가 없다.
- 비신뢰적 서비스: 수신 노드는 송신 노드에게 ACK을 보내지 않는다.
- CSMA/CD 지원

---

### 이더넷의 장단점?

장점

- 적은 용량의 데이터를 전송할 경우 성능이 우수하다. (하나의 링크를 여러 노드가 공유하고 있기 때문이다.)
- 설치 비용이 저렴하고 관리가 쉽다.

단점

- 네트워크 사용시 충돌이 발생하며, 충돌로 인해 지연이 발생한다.

---

## OSI Network Layer(3계층) & TCP/IP Internet Layer(2계층)

### OSI Network layer(TCP/IP Internet layer)란?

- 데이터 전송 과정에서 라우팅(routing)과 포워딩(forwarding)을 통해 전송 경로를 결정해주는 모듈.
- 데이터를 종단 목적지까지 가장 안전하고 빠르게 전달하는 기능을 한다.

> 3계층의 PDU는 '패킷'이다.

---

### 라우터란?

- LAN과 LAN을 연결해주는 장치.
- 수신된 패킷을 라우팅하는 역할을 한다.

> 라우터는 네트워크 계층에서 사용되는 대표적인 장비이다.

---

### 라우팅이란?

라우팅 알고리즘을 통해 최적의 경로를 얻어내어, 데이터를 목적지까지 전송하는 것.

---

### 정적 라우팅과 동적 라우팅이란?

정적 라우팅(static routing): 관리자가 수동으로 router에 필요한 정보를 입력해주는 라우팅 방식.

- 장점: 라우터의 직접적인 처리 부하가 감소한다.
- 단점: 네트워크 변화에 대응할 수 없음 → 관리자가 지속적으로 업데이트해주어야 한다.

동적 라우팅(dynamic routing): 라우팅 알고리즘을 통해 경로 설정이 자동으로 진행되는 라우팅 방식.

- 장점: 네트워크 환경이 변화해도 능동적인 대처가 가능하다.
- 단점: 네트워크 환경 변화 시 경로 재설정 → 처리부하 증가 → 지연 발생

---

### 포워딩이란?

라우터에서 입력 포트로 수신한 패킷을 목적지에 맞게 적절한 출력 포트로 패킷을 이동시키는 것.

---

### 포워딩 테이블이란?

- 수신된 패킷의 정보와, 패킷이 최적의 경로로 전송될 수 있는 출력 포트가 기록된 테이블.
- 라우팅을 통해 entry가 채워진다.

---

### 스위치와 라우터의 차이점은?

스위치

- 같은 네트워크 내에서 데이터의 목적지를 확인해 전달하는 역할

라우터

- 스위치와 스위치를 연결해서, 서로 다른 네트워크에 속한 컴퓨터끼리 통신이 가능하게 해주는 역할

---

### 스위치와 라우터의 공통점은?

1. 저장 후 전달(store-and-forward)

- 스위치: 데이터 링크 계층 헤더(frame header) 조사
- 라우터: 네트워크 계층 헤더(ip header) 조사

2. 테이블 관리

- 스위치: MAC 주소 테이블과 ARP 테이블 관리
- 라우터: 포워딩 테이블과 ARP 테이블 관리

---

### AS(Autonomous System, 자치 시스템)란?

하나의 네트워크 관리자에 의해 관리되는 라우터 집단.

- 같은 AS 내의 라우터들은 infra-AS routing protocol로서 같은 라우팅 알고리즘을 가진다.
- 다른 AS의 라우터들은 서로 다른 infra-AS routing protocol을 가질 수 있다.

필요한 이유: 전세계 수많은 호스트를 독립적인 영역으로 나눔으로써 관리와 확장이 용이하도록 하기 위함.

> gateway router란?
>
> - 다른 AS의 라우터에 직접 연결된 라우터.
> - 내부 AS에서 외부 목적지 AS로 패킷을 전달하는 역할.

---

### IP(Internet Protocol)란?

패킷의 IP 주소 부분을 처리해서 목적지까지 도달할 수 있도록 도와주는 프로토콜.

- best effort service: 데이터그램의 전송을 위해 최선의 노력을 하지만, 신뢰성을 보장하지 않음. (즉, 패킷을 송신하기는 하지만 그 패킷이 도착할 것이라는 보장은 없다.)
- 비연결형 서비스

> - IP는 network layer의 대표적인 프로토콜 중 하나이다.
> - _연결형 서비스와 비연결형 서비스의 차이점은?_ 참고

---

### 네트워크에서 '신뢰성'이 의미하는 것은?

- 네트워크에서 데이터 전송 간 문제가 발생해도 사용자가 이를 느끼지 못하도록 조치해 서비스를 계속할 수 있는 능력.
- 즉, 오류 제어와 흐름 제어를 제공하면 신뢰성을 제공하는 것이다.

---

### ICMP(Internet Control Message Protocol)란?

- IP 패킷을 처리할 때 발생되는 문제를 알려주는 프로토콜
- IP의 비신뢰성을 보완하기 위한 방법이다.

> (배경)
>
> - IP는 best effort service로, 패킷을 목적지에 전송하기 위해 최선의 노력을 하지만 어떤 문제로 인해 도착하지 않았을 때 출발지 호스트에서 알 수 있는 방법이 없다.
> - 이렇게 패킷이 제대로 도착하지 않았을 경우를 보완할 수 있는 것이 ICMP이다.

> ICMP는 에러 상황(목적지에 해당하는 호스트가 없을 때, 해당 포트에 대기 중인 서버가 없을 때 등)이 발생한 경우 IP 헤더에 기록된 출발지 호스트로 에러에 대한 상황을 보내주는 역할을 한다.

> ICMP에서 사용하는 에러 메시지의 종류
>
> - Destination Unreachable: 목적지에 도달하지 못함
> - Time Exceeded: 시간이 오래 걸려 목적지에 도달하지 못함

---

### IP의 데이터그램 단편화(fragmentation)란?

단편화

- MTU보다 큰 데이터그램을 더 작은 크기로 분할하는 과정

> MTU(Maximum Transmission Unit)
>
> - 최대 전달 크기
> - MTU보다 큰 데이터그램은 전송 불가.
>
> - MTU는 정확히는 링크 계층(Link layer / Physical + Data-link layer)의 프레임이 최대로 전달할 수 있는 데이터의 양이다. 링크 계층은 IP 데이터그램을 링크 계층의 프레임 안으로 캡슐화하므로, IP 데이터그램의 길이에 엄격한 제한을 두는 것이다.
> - 단편화를 거쳐 데이터그램이 수신지에 도착하면, 수신자가 데이터그램을 재조립(reassembly)하는 과정을 거친다.

---

### IP 데이터그램 단편화/재조립에 사용되는 IP 헤더의 종류에는 어떤 것들이 있을까?

`Frag`

- 데이터그램이 단편화된 상태를 나타냄.

`Fragment Offset`

- 단편화 되기 전 데이터의 시작점으로부터의 거리(차이)

`Total Length`

- 헤더와 데이터 길이를 합한 길이

`Identification`

- 데이터그램이 단편화되어 전송된 후, 재조립 시 사용됨.

---

### IPv6란?

IPv4의 주소 부족 문제를 해결하기 위해 등장한 주소체계.

> IPv4는 32비트로 표현되는 주소체계로, 약 43억개의 주소 밖에 표현할 수 없다.

특징

- 확장된 주소 공간: 128비트 주소 체계 사용
- 주소 설정이 자동화: 기존 IPv4에서 DHCP 등으로 이뤄졌던 host configuration이 자동화됨. (기존 네트워크 관리자로부터 IP 할당 → IPv6 네트워크 접속 시 자동으로 주소 할당)
- 보안 기능이 기본 제공: IP 수준에서의 보안에 대한 지원이 별도의 프로그램 없이 IPv6의 확장 헤더를 통해 수행됨.

> 기타
>
> - QoS를 지원한다: IPv6의 Flow Label이라는 필드를 사용
> - IPv6는 고정된 헤더 크기를 가진다. (↔ IPv4: 가변 헤더 크기)
> - IPv6는 단편화를 허용하지 않는다. 점보그램 옵션을 사용하면 임의의 큰 패킷을 주고 받을 수 있게 된다.
> - IPv4의 필요 없는 체크섬을 제거했다.

> QoS(Quality of Service): 데이터 전송에 있어서 응용 프로그램, 사용자, 데이터 흐름 등에 우선 순위를 정해 특정 수준의 성능을 보장하는 서비스.

---

### ARP(Address Resolution Protocol)란?

(네트워크 상에서) IP 주소를 MAC 주소에 대응시키기 위한 프로토콜.

> - network layer에 속하는 프로토콜이다.

> 데이터 통신에 ARP가 필요한 이유는?
>
> 일반적으로 통신을 위해 필요한 값들은 사용자가 결정해 입력해준다. 예를 들어,
>
> - transport layer에 필요한 포트 번호는 어플리케이션을 동작시키면서 입력된다.
> - network layer에 필요한 ip 주소는 사용자가 주소를 입력하면서 encapsulation된다.
>
> 그러나, data-link layer에서 필요한 물리 주소는 따로 입력이 되지 않아 디바이스 스스로 주소를 결정해주어야 한다. 이때 사용되는 프로토콜이 ARP 프로토콜이다.

---

### ARP 테이블이란?

IP 주소와 MAC 주소가 일대일로 매칭되어 있는 테이블.

> - ARP 테이블은 LAN 상의 모든 노드(호스트, 라우터, 즉 네트워크 통신이 가능한 모든 장비)가 가지고 있다.
> - ARP 테이블의 plug-and-play: 시스템 관리자의 개입 없이도 자동으로 구축됨.

---

### 같은 LAN 상에서의 전송에서 ARP가 진행되는 과정은?

1. 노드 A에서 노드 B로 데이터그램을 전송한다.

- (A의 ARP 테이블에 B의 MAC 주소 엔트리가 아직 없다.)

2. A는 ARP 질의 패킷을 broadcast로 전송한다.

- 질의 패킷의 MAC 주소는 모든 byte가 F로 설정된 broadcast 주소이며, B의 IP 주소를 포함하고 있다.
- LAN 상의 모든 노드가 질의 패킷을 수신한다.

3. 그 중 질의 패킷을 수신한 B는 응답 패킷을 A에게 unicast한다.

- 응답 패킷에는 B의 MAC 주소가 포함.

4. A는 ARP 테이블에 B의 IP와 MAC 주소를 저장한다.

---

### DHCP(Dynamic Host Configuration Protocol, 동적 호스트 구성 프로토콜)란?

호스트의 IP 주소와 각종 TCP/iP 통신에 필요한 기본 설정을 클라이언트에게 자동으로 제공해주는 프로토콜.

- DHCP 서버는 네트워크 통신에 사용되는 IP 주소를 중앙에서 관리하고,
- DHCP 지원을 받는 클라이언트는 네트워크 통신 설정 과정에서 DHCP 서버에 IP 주소를 요청하고 이를 얻을 수 있다.

---

### DHCP의 장단점?

장점

- 알아서 네트워크 통신에 필요한 설정을 해주기 때문에 효율적이고 편리하다.
- 중앙에서 IP를 관리하기 때문에 IP 충돌을 막을 수 있다.

단점

- DHCP 서버에 의존 → 다운되면 IP 할당이 이뤄지지 않는다.

---

### DHCP에서 IP 주소를 할당 받으면 영원히 사용할 수 있을까?

아니다. DHCP는 IP 주소를 '임대'해준다.

- DHCP 서버가 클라이언트에 IP 주소를 할당할 때 임대 기간을 명시한다. 클라이언트는 해당 기간동안만 IP 주소를 사용할 수 있다.
- 만약 해당 IP 주소를 더 사용하고자 한다면 'IP 주소 임대기간 연장'을 DHCP 서버에 요청한다.
- IP 주소가 더 이상 필요하지 않다면 'IP 주소 반납 절차'를 수행한다.

---

### DHCP가 ip주소를 임대해주는 절차? `보충`

[https://velog.io/@hidaehyunlee/더-편리한-인터넷을-위해-DHCP-DNS-프로토콜](https://velog.io/@hidaehyunlee/%EB%8D%94-%ED%8E%B8%EB%A6%AC%ED%95%9C-%EC%9D%B8%ED%84%B0%EB%84%B7%EC%9D%84-%EC%9C%84%ED%95%B4-DHCP-DNS-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C)

---

## OSI Transport Layer(4계층) & TCP/IP Transport Layer(3계층)

### Transport Layer란?

프로세스 간 논리적 통신을 제공하는 모듈.

- 흐름 제어와 오류 제어를 통해 신뢰성 있는 전송을 지원한다.

> - Transport layer는 흐름 제어, 혼잡 제어, 오류 제어를 제공한다.
> - Trasport layer에서 논리적 연결이 성립되는 과정: "_가상회선 방식에서 논리적 연결이 성립되는 과정_" 참고

> Data-link Layer와 Transport Layer 모두 오류 제어와 흐름 제어를 제공하는데, 둘의 차이점은
>
> - data-link layer는 물리적 연결에 대한 오류/흐름 제어를 수행하고,
> - transport layer는 (더 상위 계층의) 논리적 연결에 대한 오류/흐름 제어를 수행한다는 것이다.

---

### network layer(3계층)와 Transport Layer(4계층)와의 차이점은?

Network layer는 호스트 간 서비스, Transport layer는 프로세스 간 서비스이다.

> 호스트: 네트워크에 연결된 컴퓨터. (또는, IP를 가지고 있고 양방향 통신이 가능한 컴퓨터)

---

### Transport Layer가 흐름 제어를 제공하는 방법?

1. Stop and wait 기법: 매번 전송한 패킷에 대해 확인 응답을 받아야만 그 다음 패킷을 전송하는 방법.

2. 슬라이딩 윈도우 기법: 윈도우를 통해 '동적으로' 흐름 제어를 지원하는 방식.

- 수신 측에서 설정한 윈도우 크기만큼, 송신 측에서 확인 응답(ACK)없이 전송할 수 있게 한다.
- 송신 측이 윈도우에 포함되는 모든 패킷을 전송한 후, 수신이 확인되는 대로 윈도우를 옆으로 옮겨 다음 패킷들을 전송한다.

> - 동적으로 흐름을 제어한다는 말은, 상황에 따라 윈도우 크기를 조절할 수 있음을 의미한다.
> - TCP/IP를 사용하는 모든 호스트들은 송신을 위한 윈도우와 수신을 위한 윈도우를 각 1개씩 가지고 있다.
> - 송신측은 TCP 3 way handshaking을 통해 수신측의 윈도우 사이즈를 알 수 있게 된다.

---

### 혼잡 제어(Congestion control란?

송신측 데이터 전송 속도와 네트워크의 데이터 처리 속도 차이를 해결하는 기법.

> 네트워크의 데이터 처리 속도라는 것은 곧, 네트워크 전송 경로 상에 존재하는 호스트와 라우터들의 데이터 처리 속도를 말한다.

---

### Transport Layer가 혼잡 제어를 제공하는 방법?

AIMD, Slow start, Fast retransmit, Fast recovery등의 혼잡 제어 알고리즘을 사용한다.

---

### AIMD(합 증가/곱 감소)란?

- 처음에 패킷을 하나씩 보내고, 문제 없이 도착하면 윈도우 사이즈를 1씩 증가시켜 전송.
- 패킷 전송에 실패하거나 일정 시간을 넘으면 윈도우 사이즈를 절반으로 줄인다.

> - "Additive Increase / Multicative Decrease"
> - 공평한 방식: 여러 네트워크가 하나의 호스트를 공유하는 상황에서, 나중에 진입한 네트워크가 처음에는 불리하지만 시간이 지날 수록 평형의 상태에 가까워진다.
> - 문제 1: 처음에는 네트워크의 높은 대역폭을 다 활용하지 못함.
> - 문제 2: 네트워크 혼잡을 미리 감지하지 못함. 혼잡해지고 나서야 줄이는 방법.

---

### Slow start(느린 시작)란?

- 최초에 전송하는 패킷에 대해 각각의 ACK 값이 도착할 때마다 윈도우 사이즈를 1씩 증가시킨다.
- 혼잡 현상이 발생하면 윈도우 사이즈를 1로 떨어트린다.
- 이후에는 혼잡 현상이 발생하는 사이즈의 절반까지는 똑같이 2배씩 증가시키고, 이후부터는 완만하게 1씩 증가시킨다.

- AIMD와는 다르게 윈도우 사이즈가 지수 함수꼴로 증가한다. (대역폭 활용까지 오래 걸린다는 단점 극복)

---

### Fast retransmit(빠른 재전송)이란?

![Network%200208784d439545d2a6f93e6c5c4355bc/Untitled%201.png](Network%200208784d439545d2a6f93e6c5c4355bc/Untitled%201.png)

- 수신측에서, 먼저 도착해야 할 패킷이 도착하지 않고 다음 패킷이 도착하면 이전에 잘 도착한 마지막 패킷의 순번을 ACK 값에 실어 보낸다.
- 송신측에서는 중복된 ACK 값을 받게 된다. 중복된 ACK 값을 3번 받게 되면 패킷 손실로 판단하고, 문제가 되는 순번의 패킷을 재전송한다.
- 이러한 현상은 혼잡한 네트워크 상황으로 인해 발생하므로, 혼잡을 감지하고 윈도우 사이즈를 줄인다.

---

### Transport Layer가 오류 제어를 제공하는 방법은?

수신 확인(데이터가 잘 도착했는지)와 오류 검출, 오류 처리로 구성된다.

수신 확인

- 송신 측에서 Sequence Number를 전송
- 수신 측에서 Sequence Number + 1 값을 ACK으로 전송해서 수신 확인

오류 검출/처리

- CRC 사용해 무결성 검사.
- 오류 발생 시 수신측에서 송신측에 재발송 요청

---

## TCP & UDP

### TCP(Transmission Control Protocol)란?

Transport Layer의 프로토콜 중 하나로, 가상 회선 방식을 사용하는 연결형 서비스.

특징

- 가상 회선 방식을 사용하는 연결형 서비스.
- 흐름 제어, 혼잡 제어, 오류 제어를 통해 신뢰성을 보장.
- 서버와 클라이언트가 1:1로 연결된다.
- UDP에 비해 속도가 느리다.

> - TCP는 3-way handshake로 논리적 연결을 성립하고, 4-way handshake로 논리적 연결을 해제한다.
> - TCP는 전이중, 점대점 방식을 사용한다.

> UDP에 비해 속도가 느린 이유
>
> - 흐름 제어, 혼잡 제어, 오류 제어 등이 CPU 자원을 사용하기 때문.
> - 패킷에 대한 응답을 해야 하기 때문. (→ 시간 지연)

> TCP가 전송할 수 있는 데이터의 크기 제한  
> : TCP는 스트림 전송으로, 전송 데이터의 크기가 무제한이다.
>
> - 스트림: 데이터, 패킷, 비트 등이 일련의 연속성을 갖는 흐름.
> - TCP는 데이터를 무제한으로 전송할 수 있지만, Network layer에서 MTU에 따라 데이터를 분할, Data-link layer에서 프레이밍을 통해 분할됨.

> (1:1 연결의 한계 극복 대안) MPTCP(: Multipath TCP)
>
> - MPTCP는 다수의 TCP 경로를 구성하고, 구성한 다수 경로로 동시에 데이터를 송수신하는 방법이다. (예를 들어, 100Mbps(Mege bit per second) 속도의 대역폭과 500Mbps 속도의 대역폭이 있다면, MPTCP는 이를 하나의 망인 것처럼 구성해 최대 600Mbps의 대역폭으로 사용할 수 있다.)

---

### UDP(User Datagram Protocol)란?

Transport layer의 프로토콜 중 하나로, 데이터그램 방식을 사용하는 비연결형 서비스.

특징

- 데이터그램 방식을 사용하는 비연결형 프로토콜.
- (흐름 제어, 혼잡 제어 등을 제공하지 않아) 신뢰성이 낮다.
- 서버와 클라이언트가 N:M(1:1, 1:N, N:M 등)으로 연결될 수 있다.
- TCP에 비해 속도가 빠르다.

> - UDP는 메시지에 대한 확인 응답(ACK)이 없다.

> UDP는 헤더의 체크섬 필드를 통해 최소한의 오류만 검출한다.
>
> - 송신측은 데이터를 전송하기 전에 데이터 값을 사용해 체크섬(데이터가 변형되지 않았는지 확인하는 값) 값을 계산하고, 데이터에 담아 전송한다.
> - 수신측은 데이터 값을 사용해 다시 체크섬 값을 계산하고, 함께 전송된 체크섬 값과 비교한다.

> UDP가 전송할 수 있는 데이터의 크기 제한  
> : (UDP는 데이터그램 방식으로 통신하므로) 데이터가 데이터그램 단위로 전송되며, 그 크기는 '이론상' 65,535($2^{16}-1$) 바이트로, 크기가 초과하면 잘라서 보낸다.
>
> (UDP 패킷의 최대 크기는 '이론상' 65,535 byte이지만, 실제 구현에서는 해당 패킷을 실어나르는 호스트에 따라 그 최대 길이가 결정된다.)
>
> - UDP도 근본적으로는 network layer의 IP 프로토콜에서 운용된다는 점을 고려할 수 있다.
> - TCP/IP 표준이 게시된 RFC를 참고하면, 모든 장비는 약 500byte까지의 데이터그램을 처리할 수 있어야 함을 명시하고 있다.
> - 바꾸어 말하면, IPv4에서는 500byte 이상의 데이터그램에 대해서는 보장되지 않음을 의미한다.
> - 따라서, IPv4 위에서 운용된다는 점을 고려할 때 실질적인 UDP의 패킷 크기는 약 500byte라고 볼 수 있다.
>   (https://scrapsquare.com/notes/udp-length)

> (참고) RFC란?
>
> - Requests For Comments. 즉, 컴퓨터 공학 분야에 적용될 수 있는 여러 연구, 기법 등에 대한 메모.
> - TCP/IP의 표준이 RFC에 게시되어 있다.
>   (단, 정의에서 알 수 있듯이 모든 RFC가 표준은 아니다.)

---

### 연결형 서비스와 비연결형 서비스의 차이점은?

연결형 서비스

- 송신자와 수신자 사이에 논리적 연결을 확립하고 데이터를 전송하는 방법.
- 오류 발생 시 재전송을 해, 신뢰성 있는 전송.
- (전송되는 데이터가 모두 동일한 경로를 이용하기 때문에) 전송된 데이터의 순서와 목적지에 도착하는 데이터 순서가 동일하다.
  > - 대표적으로 가상 회선 방식이 있다.

비연결형 서비스

- 송신자와 수신자 사이에 논리적 연결을 확립하지 않고 데이터를 전송하는 방법.
- 오류 발생 시 재전송하지 않아 신뢰성 없는 전송.
- 연결 확립에 걸리는 시간이 없어 전송 속도가 빠르다.
  > - 대표적으로 데이터그램 방식이 있다.

---

### 데이터그램 방식과 가상 회선 방식이란?

데이터그램 방식

- 데이터를 전송하기 전에 논리적 연결이 설정되지 않고 전송되는 방식.
- 패킷은 독립적으로, 서로 다른 경로를 통해 전송된다.
- 송신한 순서와 수신한 순서가 다를 수 있다.
- 상대적으로 속도가 느리다. 특정 교환기(노드)에 트래픽이 몰려 지연 현상이 발생하기 때문이다.

가상 회선 방식

- 데이터를 전송하기 전에 논리적 연결을 설정하고 전송하는 방식.
- 최초 경로 설정할 때 한 번 경로가 선택되고 그 경로가 가상 회선.
- 패킷은 송신한 순서대로 도착한다.
- 속도가 빠르다. 여러 노드에 트래픽이 분산되기 때문이다.

> 가상회선 방식과 데이터그램 방식의 공통점은?
>
> - 둘 다 '패킷 교환 방식'의 일종이다.
> - 데이터를 패킷으로 분할해 전송한다.

> 사용하기 적합한 데이터 특성
>
> - 가상회선 방식: 다량의 데이터를 정해진 시간 안에 연속으로 전송할 때(신뢰성이 보장되기 때문이다.)
> - 데이터그램 방식: 짧은 메시지를 일시적으로 전송할 때(속도가 빠르기 때문이다.)

> 네트워크 내 특정 노드가 다운되었을 때의 차이점
>
> - 데이터그램 방식: 다른 경로를 새로 설정.
> - 가상회선 방식: 해당 노드를 지나는 가상회선의 전체 경로를 잃게 된다.

---

### 가상 회선 방식에서 논리적 연결이 설정되는 과정은?

![Network%200208784d439545d2a6f93e6c5c4355bc/Untitled.png](Network%200208784d439545d2a6f93e6c5c4355bc/Untitled.png)

1. 송신지 노드가 논리적 연결을 요구하는 제어 패킷을 전송.

2. 제어 패킷을 수신한 라우터들은 각자의 virtual circuit table을 완성시키면서 다음 라우터로 제어 패킷을 전달.

- virtual circuit table은 수신된 패킷의 VCI, 즉 virtual circuit identifier와 수신된 port 번호를 incoming section에 기록하고, 내보낼 port 번호를 outgoing section에 기록

3. 제어 패킷을 받은 수신지 노드는 논리적 연결에 대한 응답을 송신지에 전송. 이 과정에서 virtual circuit table이 완성된다.

4. 이후 해당 논리적 연결을 통해 전송되는 패킷은 주소 정보 대신 VCI 값에 의해 데이터 전송이 이루어짐.

---

### 회선 구성 방식에는 어떤 것들이 있을까?

1. 점대점(point-to-point) 방식

   : 두 장치 간 1:1 회선을 이용해 연결되는 방식.

   장점

   - 회선 구성이 간단하다.
   - 대용량 전송에 유리하다.
     (회선이 전송할 수 있는 데이터량은 한정되어 있으므로, 데이터를 주고 받는 주체가 적을 수록 더 많은 양의 데이터를 주고 받을 수 있을 것이다.)

   단점

   - 1:1 통신을 위해 별도의 회선 설치 → 높은 설치 비용

   > 점대점 방식은 Data-link layer의 프로토콜 중 하나이며, network layer(osi 3) 등 다양한 타 계층에서도 사용할 수 있도록 발전되었다.

2. 다중점(multi-point) 방식

   : 하나의 회선에 여러 개의 장치가 연결되어 통신하는 방식.

   장점

   - 송수신하는 데이터의 양이 적을 때 효율적이다.

   단점

   - 구성 비용은 줄일 수 있으나 설계가 복잡하다.

> - '회선 구성': 둘 이상의 장치가 하나의 회선(링크)에 연결되는 방식.
> - '회선' : 하나의 장치에서 다른 장치로 데이터를 보내는 통신 경로.

---

### 전이중, 반이중, 단방향 방식에 대해 설명해본다면?

- 전이중 방식(full-duplex) : 두 개의 통신 장치가 동시에 송, 수신이 가능한 통신 방식
- 반이중 방식(half-duplex) : 두 개의 통신 장치가 송, 수신을 할 수 있지만, 한 번에 한 쪽 방향으로만 통신할 수 있는(데이터를 수신하는 동안에는 송신할 수 없는) 통신 방식
- 단방향 방식(simplex) : 송신, 혹은 수신만 할 수 있는 통신 방식

---

### TCP와 UDP는 각각 어떤 특성의 서비스에 적합할까?

TCP

- 연속성보다 신뢰성 있는 전송이 중요한 서비스
- 예) 파일 전송

UDP

- 신뢰성보다는 real time을 보장하거나 빠른 연결이 필요한 서비스
- 예) 실시간 (스트리밍) 서비스

> UDP는 TCP에 비해 다음과 같은 이점이 있다.
>
> 1.  신속성
>
>     - TCP는 흐름, 혼잡, 오류 제어로 데이터를 재전송하거나 속도를 제어. 반면 UDP는 UDP 세그먼트로. 만들고 바로 네트워크 계층으로 전송. → 조금의 데이터 손실을 감수하면 지나친 latency를 방지할 수 있다.
>     - 연결 설정이 없다.
>
> 2.  수용성
>
>     - TCP는 종단 호스트에서 연결 상태(수신 버퍼, 송신 버퍼, sequence, ack number 등)를 유지. 이에 반해 UDP는 연결 상태를 유지하기 위한 어떤 파라미터도 기록하지 않음 → 더 많은 클라이언트를 수용할 수 있다.

> UDP에 적절한 서비스들
>
> - 비디오 스트리밍: 신속성
> - DNS: 신속성, 수용성
> - IPTV: IP 사용하는 디지털 텔레비전 서비스. 신속성(실시간 비디오 스트리밍과 같은 결)
> - 음성 인터넷 프로토콜(VoIP): ip를 사용하는 음성 통신 기술. 신속성.
> - TFTP: (↔ FTP with TCP) 간단한 버전의 FTP(File Transfer Protocol). 단순하고 빠르게 파일을 전송하는 목적.
> - IP 터널: 두 ip 네트워크를 연결하는 대화 채널.
> - 온라인 게임: 신속성. 실시간.

---

### 3-way handshake의 과정에 대해 설명해본다면?

최초의 클라이언트와 서버에 대해

- (상태) 클라이언트: `CLOSED`, 서버: `LISTEN`

> - 클라이언트가 서버로 연결 요청을 하기 이전에, 서버는 (연결 요청에 대한 준비로) port를 listen하고 있어야 한다. 이를 passive open이라고 한다.
> - 클라이언트가 서버에게 연결 요청을 보냄으로써 3-way handshake를 시작하는 것을 active open이라고 한다.

클라이언트 → 서버

- 클라이언트가 서버에게 연결 요청 메시지 `SYN`을 전송.

  - `SYN` 메시지는 `SYN` flag 비트를 1로 설정한 세그먼트이다.
  - `SYN`의 sequence number에는 클라이언트가 랜덤으로 선택한 값(ex: `A`)이 담겨진다.

- (상태) 클라이언트: `CLOSED`, 서버: `SYN_RSV`

클라이언트 <- 서버

- 서버는 클라이언트에게 `SYN` + `ACK`을 전송해서, 요청 수락과 동시에 클라이언트도 포트를 열어달라는 메시지를 보낸다.

  - `SYN-ACK` 메시지는 `SYN`과 `ACK` 비트가 1인 세그먼트이다.
  - acknowledgement number는 이전에 클라이언트가 `SYN`에 담아 보낸 sequence number에 1을 더한 값(ex: `A+1`)으로 설정된다.
  - sequence number에는 서버가 랜덤으로 선택한 값(ex: `B`)이 담겨진다.

- (상태) 클라이언트: `CLOSED`, 서버: `SYN_RSV`

클라이언트 → 서버

- 클라이언트는 서버에게 수락 메시지 `ACK`을 보낸다.
  - sequence number는 이전에 받은 acknowledgement number(ex: `A+1`)로 설정된다.
  - acknowledgement number는 이전에 받은 sequence number에 1을 더한 값(ex: `B+1`)으로 설정된다.
- (상태) 클라이언트: `ESTABILISHED`, 서버: `ESTABILISHED`

---

### 4-way handshake의 과정에 대해 설명해본다면?

![Network%200208784d439545d2a6f93e6c5c4355bc/connection-termination.png](Network%200208784d439545d2a6f93e6c5c4355bc/connection-termination.png)

최초

- (상태) 클라이언트: `ESTABILISHED`, 서버: `ESTABILISHED`

클라이언트 → 서버

- 클라이언트가 연결 종료를 요청하는 `FIN` 메시지를 서버에게 전송
- (상태) 클라이언트: `FIN_WAIT_1`, 서버: `ESTABILISHED`

서버 → 클라이언트

- 서버는 클라이언트에게 일단 확인 메시지 `ACK`을 보낸다.
  > (상태) 클라이언트: `FIN_WAIT_2`(active close), 서버: `CLOSE_WAIT` (passive close)
- 그리고, 서버는 자신의 통신이 끝날 때까지 마저 전송하며 기다린다.
- 서버의 통신이 끝나면, 클라이언트에게 연결 종료 요청에 합의한다는 의미로 `FIN` 메시지를 보낸다.
  > - (상태) 클라이언트: `TIME_WAIT`, 서버: `LAST_ACK`
  > - 클라이언트는 `TIME_WAIT` 상태에서 최종적으로 연결을 닫기 전까지 일정 시간을 기다린다(연결을 닫혀있다는 것은, 해당 local port가 새로운 연결을 맺을 수 없는 상태를 말한다). 이는 전송이 지연된 패킷이 뒤늦게 도착해 혼동이 생기는 것을 방지하기 위함이다.

클라이언트 → 서버

- 클라이언트는 서버에게 확인했다는 메시지 `ACK`를 보낸다.

> 메시지(세그먼트)가 SYN인지, ACK, FIN 등인지 나타내는 방법
>
> - TCP 헤더의 control bit를 사용한다.
> - control bit는 총 6비트이며, 각각의 비트는 SYN, ACK, FIN 등을 나타낸다.

---

### 왜 2-way handshake는 성립될 수 없을까?

- TCP/IP 통신은 양방향 통신이다.
- 통신간 상대방의 특정 메시지를 받았다는 것을 알리는 데 sequence number가 사용된다. (받은 메시지의 sequence number+1을 담아 보냄으로써)
- TCP/IP는 양방향 통신이므로, 양쪽에서 서로의 메시지를 받았음을 알려줄 수 있어야 한다.
- 이를 위해서는 sequence number가 각각 1개씩 필요하며, 각 sequence number는 호스트가 고른 random한 숫자로 초기화된다. (ISN: Initial Sequence Number)
- 2-way로는 한 쪽의 sequence number만 사용할 수 있다. 따라서 3-way로 양쪽의 호스트가 ISN을 공유하는 과정이 필요하다.

> 2-way  
> (1) 클라이언트가 서버에게 `SYN` 패킷 전송  
> (2) 서버가 클라이언트에게 `ACK` 패킷 전송

---

## OSI Application Layer(응용 계층, 7계층) & TCP/IP Application Layer(4계층)

> OSI Session Layer(5계층)
>
> - 응용 프로그램간 세션을 지원하는 계층.
> - 세션 설정, 통신 응답 대기시간 등 세션과 관련된 작업을 처리한다.
>
> OSI Presentation Layer(6계층)
>
> - 데이터가 표현되는 방식을 담당하는 계층.
> - 데이터의 암호화 및 복호화, 인코딩(ASCII 등) 및 디코딩, 데이터 표현 형식(JPG, JPEG 등)을 처리한다.

### Application Layer란?

- 어플리케이션 간 데이터 교환을 담당하는 모듈
- 사용자가 어플리케이션과 상호작용할 수 있도록 인터페이스를 제공

> - TCP/IP의 application layer는 OSI session layer, presentation layer, application layer에 해당한다.
> - 응용 계층의 프로토콜
>
>   - TCP 기반: HTTP 등
>   - UDP 기반: DNS, DHCP 등

---

## DNS

### DNS(Domain Name Server)란?

도메인을 ip주소로 변환해주는 서버, 혹은 시스템

> DNS가 사용되기 이전에는, 각 컴퓨터마다 가지고 있는 hosts.txt 파일을 사용했다.
>
> - hosts.txt 파일은 호스트명과 ip주소 정보가 저장되어 있었다.
> - 각 클라이언트는 FTP를 사용해 hosts 파일을 다운로드했다.
> - Web 서비스 사용자가 폭발적으로 증가하면서, 많은 host에 대한 정보를 파일로 관리하기 힘들어졌다.

---

### 도메인 네임(domain name)이란?

네트워크 상에서 컴퓨터를 식별하는 호스트명

---

### 도메인 네임의 구조?

오른쪽부터 1, 2, 3단계 도메인으로 구성되어 있으며, 왼쪽으로 갈 수록 도메인의 범위가 작아진다.
(예: Whois.co.kr)

- 1단계 도메인(top level domain): 국가 도메인
- 2단계 도메인(second level domain): 도메인의 성격
- 3단계 도메인(third level domain): 도메인 네임을 등록하는 사람이 원하는 이름

보통 앞에 붙는 `www.`은 도메인 네임에 포함되지 않는 '호스트명'이다.

- 도메인을 가지고 있으면, 앞에 수많은 호스트명을 붙여 다양한 호스트 서버를 운영할 수 있다.
  (ex: www.naver.com, shopping.naver.com, mail.naver.com, ...)
- 도메인 네임은 논리적 그룹(.com), 호스트명은 실제 서버에 주어진 컴퓨터의 이름(www, naver)이라 볼 수 있다.

---

### DNS에서 도메인을 얻어오는 과정은?

![Network%200208784d439545d2a6f93e6c5c4355bc/Untitled%202.png](Network%200208784d439545d2a6f93e6c5c4355bc/Untitled%202.png)

사용자가 브라우저에 www.naver.com를 입력 후 접속한다.

→ 브라우저는 해당 도메인과 ip주소 정보가 브라우저 캐시(Browser Cache)에 존재하는지 확인한다.

> 크롬의 경우, chrome://net-internals/#dns 에서 확인할 수 있다.

→ 브라우저 캐시에 정보가 없다면, OS에 저장된 DNS Cache를 찾는다.

> Mac OS X의 경우, `/etc/hosts`에 존재한다.

→ OS DNS Cache에 정보가 없다면, PC는 (단말의) 시스템에 설정되어 있는 local DNS에게 "www.naver.com"이라는 호스트명의 ip주소를 요청한다.

> Mac OS X의 경우, local DNS의 ip 주소가 `/etc/resolv.conf`에 존재한다.

→ local DNS는 자신의 네임 서버에서 해당 호스트명과 매칭되는 ip주소가 있는지 확인한다. 없을 경우, 루트 DNS 서버에게 DNS 요청을 보낸다.

> local DNS는 root DNS의 ip주소를 미리 알고 있다.

→ 루트 DNS는 ip주소를 찾고, 없으면 자신의 하위 레벨 DNS의 ip주소를 local DNS에게 응답한다.

- local DNS는 해당 하위 레벨 DNS에게 DNS 요청을 보낸다.
- 하위 레벨 DNS는 ip주소가 없으면 그 하위 레벨의 DNS의 ip주소를 local DNS에게 응답한다. 이렇게 반복적인 형태로 local DNS는 ip주소를 얻을 때까지 recursive(iterative) query를 전송한다.

→ 응답(ip주소)을 받은 local DNS는 도메인에 대한 ip주소를 (DNS Cache에) 캐싱하고, 해당 ip주소를 브라우저에게 전달한다.

---

### PC는 local DNS의 ip 주소를 어떻게 알고 있을까?

DHCP라는 프로토콜로 알게 된다.

---

### DNS의 구성 요소는?

- 도메인 네임 스페이스(domain name space)
- 네임 서버(name server)
- 리졸버(resolver)

---

### 도메인 네임 스페이스란?

![Network%200208784d439545d2a6f93e6c5c4355bc/Untitled%203.png](Network%200208784d439545d2a6f93e6c5c4355bc/Untitled%203.png)

DNS가 구성, 관리되는 계층적 구조

> - 최상위에 루트 DNS 서버가 존재
> - 루트 DNS 하위에 계층 구조로 DNS 서버가 구성

---

### 네임 서버란?

도메인과 ip주소 정보를 가지고 있는 서버.

> - resolver로부터 요청을 받고, 응답(ip주소)를 다시 resolver에게 전달하는 역할.

---

### 네임 서버의 종류는?

Primary Name Server

- 도메인을 관리하는 주 네임 서버

Secondary Name Server

- Primary Name Server가 고장났을 때 등의 상황에서 역할을 대신 수행할 수 있는 서버

> Secondary Name Server는 주기적으로 네임 서버로부터 정보를 받아와 자신의 정보를 갱신한다.

---

### resolver란?

DNS의 구성 요소로서,

- DNS 클라이언트의 요청을 네임 서버로 전달하고,
- 네임 서버로부터 정보(도메인 네임과 ip주소)를 받아 클라이언트에게 전송하는 역할을 한다.

> - 네임 서버의 구조(네임 서버 스페이스)를 파악하고 있다.
> - 네임 서버에 요청 받은 도메인의 ip 주소를 조회하는 기능을 가진다.
> - 조회한 네임 서버에 원하는 ip주소가 없을 경우, 다른 네임 서버에 요청을 보낸다.

---

### DNS가 사용하는 전송 계층(Transport Layer)의 프로토콜은?

- 대부분의 경우 UDP를 사용
- 약 500bytes를 초과하는 DNS 패킷을 전송해야 할 경우 TCP 사용

---

### DNS에 UDP를 사용하는 이유?

DNS는 작은 데이터를 교환하며, 굉장히 많은 클라이언트와 연결을 맺는다.

- TCP는 아무리 적은 데이터라도 논리적 연결을 맺는 데 시간과 비용이 들며, 신뢰성 확보를 위해 다양한 처리를 한다.
- UDP는 신뢰성을 보장하지 않아 오버헤드가 적게 들며, 그만큼 더 빠른 시간에, 더 많은 클라이언트와 통신을 주고 받을 수 있다.

---
